<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>AnnotateWeb</title>
  <link rel="stylesheet" href="popup.css">
</head>
<body>
  <div id="app">
    <!-- Header -->
    <div class="header">
      <h1>üìù AnnotateWeb</h1>
      <button id="settingsBtn" class="icon-btn" title="Settings">‚öôÔ∏è</button>
    </div>

    <!-- Settings Menu -->
    <div id="settingsMenu" class="settings-menu" style="display: none;">
      <button id="exportMenuBtn" class="menu-item">üì§ Export Notes</button>
      <button id="importMenuBtn" class="menu-item">üì• Import Notes</button>
    </div>

    <!-- Current Page Info -->
    <div id="currentPageInfo" class="current-page">
      <div class="page-url" id="pageUrl">Loading...</div>
    </div>

    <!-- Main View: List of Notes -->
    <div id="listView" class="view">
      <!-- Action Buttons -->
      <div class="action-bar">
        <button id="newNoteBtn" class="btn btn-primary">+ New Note</button>
      </div>
      <input type="file" id="importFileInput" accept=".json" style="display: none;">

      <!-- Notes List -->
      <div id="notesList" class="notes-list">
        <div class="loading">Loading notes...</div>
      </div>

      <!-- Empty State -->
      <div id="emptyState" class="empty-state" style="display: none;">
        <p>No notes for this page yet.</p>
        <p class="text-muted">Click "New Note" to get started!</p>
      </div>

      <!-- Footer -->
      <div class="footer">
        <span id="notesCount">0 notes</span>
      </div>
    </div>

    <!-- Edit View: Create/Edit Note -->
    <div id="editView" class="view" style="display: none;">
      <div class="edit-header">
        <button id="backBtn" class="btn btn-link">‚Üê Back</button>
        <h2 id="editTitle">New Note</h2>
      </div>

      <form id="noteForm" class="note-form">
        <div class="form-group">
          <label for="noteTitle">Title</label>
          <input type="text" id="noteTitle" class="form-control" placeholder="Note title" required>
        </div>

        <div class="form-group">
          <label for="noteUrl">URL</label>
          <input type="text" id="noteUrl" class="form-control" placeholder="https://example.com" required readonly>
        </div>

        <div class="form-group">
          <label for="urlPattern">
            URL Pattern (optional)
            <span class="help-icon" title="Use regex to match multiple URLs">?</span>
          </label>
          <input type="text" id="urlPattern" class="form-control" placeholder="^https://example\.com/.*">
          <div id="patternValidation" class="validation-message"></div>
          <button type="button" id="showExamplesBtn" class="btn-link">Show examples</button>
        </div>

        <div id="patternExamples" class="pattern-examples" style="display: none;">
          <h4>Regex Pattern Examples:</h4>
          <ul id="examplesList"></ul>
        </div>

        <div class="form-group">
          <label for="noteContent">Content (Markdown supported)</label>
          <textarea id="noteContent" class="form-control" rows="8" placeholder="# Your note here&#10;&#10;Use **markdown** for _formatting_!" required></textarea>
        </div>

        <div class="form-group">
          <label>Preview</label>
          <div id="markdownPreview" class="markdown-preview">
            <p class="text-muted">Start typing to see preview...</p>
          </div>
        </div>

        <div class="form-actions">
          <button type="submit" class="btn btn-primary" id="saveBtn">Save</button>
          <button type="button" id="cancelBtn" class="btn btn-secondary">Cancel</button>
          <button type="button" id="deleteBtn" class="btn btn-danger" style="display: none;">Delete</button>
        </div>
      </form>
    </div>
  </div>

  <!-- Scripts -->
  <script src="../lib/marked.min.js"></script>
  <script src="../lib/storage.js"></script>
  <script type="module" src="popup.js"></script>
</body>
</html>